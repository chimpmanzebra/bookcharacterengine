<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Character AI</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone@7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root">
        <div style="display: flex; justify-content: center; align-items: center; height: 100vh;">
            <h1>📚 Loading your Character Tutor...</h1>
        </div>
    </div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const CharacterTutorApp = () => {
            // Teacher Configuration State
            const [isTeacherMode, setIsTeacherMode] = useState(true);
            const [bookTitle, setBookTitle] = useState("The Giver");
            const [characterName, setCharacterName] = useState("Jonas");
            const [lessonPrompt, setLessonPrompt] = useState("How does the dystopian society change the protagonist in The Giver?");
            const [vocabularyWords, setVocabularyWords] = useState("dystopia, utopia, oppression, sameness, conformity, individuality, choice, freedom, memory, control");
            
            // Student Interaction State
            const [messages, setMessages] = useState([]);
            const [userInput, setUserInput] = useState("");
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState("");
            const [currentThesis, setCurrentThesis] = useState("");

            // Jonas response database
            const getJonasResponse = (message) => {
                const lowercaseMessage = message.toLowerCase();
                
                if (lowercaseMessage.includes("hello") || lowercaseMessage.includes("hi")) {
                    return "Hello there. I'm Jonas from the community you might know from my story. I've experienced something most people in my world never do - I've seen beyond the Sameness. When I was chosen as the Receiver of Memory, my entire understanding of our dystopian society changed. What would you like to know about my transformation?";
                }
                
                if (lowercaseMessage.includes("change") || lowercaseMessage.includes("transform")) {
                    return "The biggest change in me was awakening to the truth about our community. Before becoming the Receiver, I was just another compliant citizen accepting our oppressive system as perfect. But experiencing memories of color, emotion, and choice transformed me from obedient to rebellious. I went from trusting our controlled society to questioning everything. How do you think discovering your whole world is a lie would change someone?";
                }
                
                if (lowercaseMessage.includes("emotion") || lowercaseMessage.includes("feel")) {
                    return "Emotions were completely foreign to me at first. Our dystopian society suppressed all deep feelings through pills and conformity. But when I stopped taking the medication and received memories of joy, love, and pain, I became truly alive for the first time. These emotions made me realize what our community had sacrificed for stability. The capacity to feel transformed me from a hollow shell into a real person. What role do you think emotions play in making us human?";
                }
                
                if (lowercaseMessage.includes("family") || lowercaseMessage.includes("love")) {
                    return "Love... that was perhaps the most shocking discovery. When I asked my parents if they loved me, they said the word was meaningless - that they 'enjoyed' me instead. That moment revealed how our oppressive system had destroyed the most basic human connections. Learning about real families through memories showed me that our 'family units' were just convenient arrangements, not bonds of love. This realization changed how I saw all relationships in our controlled society.";
                }
                
                if (lowercaseMessage.includes("choice") || lowercaseMessage.includes("freedom")) {
                    return "Choice! That became my greatest desire. 'If everything's the same, then there aren't any choices!' I told The Giver. Our community eliminated choice to prevent pain and mistakes, but they also eliminated what makes life meaningful. I transformed from someone who accepted assigned roles to desperately wanting freedom to make my own decisions. This hunger for choice is what ultimately drove me to escape with Gabriel, choosing uncertainty over oppression.";
                }
                
                if (lowercaseMessage.includes("sameness") || lowercaseMessage.includes("dystopia")) {
                    return "Sameness was supposed to create equality and peace, but I learned it was really a form of oppression disguised as perfection. Our dystopian society convinced everyone that eliminating differences was good, but it actually destroyed individuality, creativity, and joy. I went from believing Sameness was wonderful to seeing it as a prison that trapped everyone's humanity. The transformation from accepting conformity to yearning for diversity changed everything about how I saw the world.";
                }
                
                if (lowercaseMessage.includes("memory") || lowercaseMessage.includes("giver")) {
                    return "The memories The Giver shared with me were life-changing. Each one showed me what we'd lost - the beauty of snow, the warmth of sunshine, the complexity of color, the depth of human experience. These memories transformed me from someone who accepted our limited existence to someone who understood what we were missing. They gave me the wisdom to see our society's oppressive nature and the courage to act against it.";
                }
                
                if (lowercaseMessage.includes("thesis") || lowercaseMessage.includes("essay") || lowercaseMessage.includes("write")) {
                    return "For your thesis, think about my complete transformation. I started as a model citizen of a dystopian society - compliant, unquestioning, emotionally flat. But exposure to suppressed memories and hidden truths changed me into someone who questioned authority, felt deep emotions, and ultimately rebelled. The oppressive system initially shaped me into conformity, but knowledge and awareness transformed me into an individual seeking freedom. What specific aspects of this change interest you most?";
                }
                
                if (lowercaseMessage.includes("community") || lowercaseMessage.includes("society")) {
                    return "Our community seemed perfect on the surface - no war, no hunger, no pain. But I discovered it was built on oppression and lies. Everyone was controlled through medication, assigned roles, and elimination of choice. As I learned the truth, I changed from someone who trusted this system to someone who saw its horror. The society that created me as a compliant citizen ultimately produced its own rebel through the very role they gave me.";
                }
                
                // Default responses for other topics
                const defaultResponses = [
                    "That's an interesting question. My experience as the Receiver taught me that dystopian societies often hide their oppressive nature behind promises of perfection. I went from trusting our system to questioning everything about it. What aspects of this transformation would you like to explore?",
                    "You know, before receiving the memories, I was exactly what our dystopian community wanted - obedient and unquestioning. But knowledge changed me completely, turning me from a compliant citizen into someone who challenged the system. How do you think awareness affects someone living under oppression?",
                    "My journey showed me how dystopian control can initially shape someone into conformity, but exposure to truth can transform them into a rebel. I changed from accepting Sameness to desperately seeking individuality and choice. What part of this change seems most significant to you?"
                ];
                
                return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
            };

            // Handle sending message
            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!userInput.trim() || isLoading) return;

                const message = userInput.trim();
                setUserInput("");
                setIsLoading(true);
                setError("");

                try {
                    // Add user message
                    setMessages(prev => [...prev, { sender: 'student', text: message }]);

                    // Simulate thinking time
                    await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 1500));

                    // Get Jonas response
                    const response = getJonasResponse(message);
                    
                    // Add Jonas response
                    setMessages(prev => [...prev, { sender: 'character', text: response }]);
                    
                } catch (err) {
                    setError("Sorry, something went wrong. Please try again.");
                    console.error(err);
                } finally {
                    setIsLoading(false);
                }
            };

            const startLesson = () => {
                setMessages([{
                    sender: 'character',
                    text: `Hello! I'm ${characterName} from ${bookTitle}. I'm here to help you explore: "${lessonPrompt}". I've been through quite a transformation in my story - from a compliant citizen to someone who questioned everything about our society. What would you like to know about my journey?`
                }]);
                setCurrentThesis("");
                setIsTeacherMode(false);
            };

            const resetLesson = () => {
                setMessages([]);
                setCurrentThesis("");
                setIsTeacherMode(true);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-800">
                    <div className="container mx-auto p-6 max-w-4xl">
                        {/* Header */}
                        <div className="text-center mb-8">
                            <h1 className="text-4xl md:text-5xl font-bold text-white mb-4 drop-shadow-lg">
                                📚 Character English Tutor
                            </h1>
                            <p className="text-white text-lg opacity-90">
                                Learn through dialogue with literary characters
                            </p>
                            <div className="bg-green-500 bg-opacity-20 backdrop-blur-sm rounded-lg p-3 mt-4 text-white text-sm">
                                <strong>✅ Working Demo:</strong> Chat with Jonas from The Giver about dystopian transformation!
                            </div>
                        </div>

                        {/* Teacher Configuration Panel */}
                        {isTeacherMode ? (
                            <div className="bg-white rounded-xl shadow-2xl p-8 mb-6">
                                <h2 className="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                                    🍎 Teacher Configuration
                                </h2>
                                
                                <div className="grid md:grid-cols-2 gap-6">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            Book Title
                                        </label>
                                        <input
                                            type="text"
                                            value={bookTitle}
                                            onChange={(e) => setBookTitle(e.target.value)}
                                            className="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-indigo-500"
                                            placeholder="e.g., The Giver"
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            Character Name
                                        </label>
                                        <input
                                            type="text"
                                            value={characterName}
                                            onChange={(e) => setCharacterName(e.target.value)}
                                            className="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-indigo-500"
                                            placeholder="e.g., Jonas"
                                        />
                                    </div>
                                </div>

                                <div className="mt-6">
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        Lesson Prompt/Essay Question
                                    </label>
                                    <textarea
                                        value={lessonPrompt}
                                        onChange={(e) => setLessonPrompt(e.target.value)}
                                        rows={3}
                                        className="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-indigo-500"
                                        placeholder="e.g., How does the dystopian society change the protagonist in The Giver?"
                                    />
                                </div>

                                <div className="mt-6">
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        Unit Vocabulary (comma-separated)
                                    </label>
                                    <textarea
                                        value={vocabularyWords}
                                        onChange={(e) => setVocabularyWords(e.target.value)}
                                        rows={2}
                                        className="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-indigo-500"
                                        placeholder="e.g., dystopia, utopia, oppression, sameness, conformity"
                                    />
                                </div>

                                <button
                                    onClick={startLesson}
                                    className="mt-6 w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg transition-colors transform hover:scale-105"
                                >
                                    🚀 Start Character Lesson
                                </button>
                            </div>
                        ) : (
                            /* Student Interface */
                            <div className="space-y-6">
                                {/* Lesson Info Header */}
                                <div className="bg-white bg-opacity-20 backdrop-blur-md rounded-xl p-6 text-white">
                                    <div className="flex justify-between items-start">
                                        <div>
                                            <h2 className="text-xl font-bold mb-2">
                                                Speaking with {characterName} from "{bookTitle}"
                                            </h2>
                                            <p className="text-sm opacity-90 mb-2">
                                                <strong>Working on:</strong> {lessonPrompt}
                                            </p>
                                            <p className="text-xs opacity-75">
                                                <strong>Key vocabulary:</strong> {vocabularyWords}
                                            </p>
                                        </div>
                                        <button
                                            onClick={resetLesson}
                                            className="bg-white bg-opacity-20 hover:bg-opacity-30 text-white px-4 py-2 rounded-lg text-sm transition-colors"
                                        >
                                            ⚙️ Teacher Settings
                                        </button>
                                    </div>
                                </div>

                                {/* Chat Interface */}
                                <div className="bg-white rounded-xl shadow-2xl">
                                    {/* Messages */}
                                    <div className="h-96 overflow-y-auto p-6 space-y-4">
                                        {messages.map((message, index) => (
                                            <div
                                                key={index}
                                                className={`flex ${message.sender === 'student' ? 'justify-end' : 'justify-start'}`}
                                            >
                                                <div
                                                    className={`max-w-xs lg:max-w-md px-4 py-3 rounded-lg ${
                                                        message.sender === 'student'
                                                            ? 'bg-indigo-600 text-white'
                                                            : 'bg-gray-200 text-gray-800'
                                                    }`}
                                                >
                                                    <div className="text-xs opacity-75 mb-1">
                                                        {message.sender === 'student' ? 'Student' : characterName}
                                                    </div>
                                                    <p className="text-sm whitespace-pre-wrap">
                                                        {message.text}
                                                    </p>
                                                </div>
                                            </div>
                                        ))}
                                        
                                        {isLoading && (
                                            <div className="flex justify-start">
                                                <div className="bg-gray-200 text-gray-800 px-4 py-3 rounded-lg max-w-xs lg:max-w-md">
                                                    <div className="text-xs opacity-75 mb-1">{characterName}</div>
                                                    <div className="flex items-center space-x-2">
                                                        <div className="flex space-x-1">
                                                            <div className="w-2 h-2 bg-gray-500 rounded-full animate-bounce"></div>
                                                            <div className="w-2 h-2 bg-gray-500 rounded-full animate-bounce" style={{animationDelay: '0.1s'}}></div>
                                                            <div className="w-2 h-2 bg-gray-500 rounded-full animate-bounce" style={{animationDelay: '0.2s'}}></div>
                                                        </div>
                                                        <span className="text-xs text-gray-500">thinking...</span>
                                                    </div>
                                                </div>
                                            </div>
                                        )}
                                    </div>

                                    {/* Input Form */}
                                    <div className="border-t border-gray-200 p-6">
                                        <form onSubmit={handleSubmit} className="flex gap-4">
                                            <input
                                                type="text"
                                                value={userInput}
                                                onChange={(e) => setUserInput(e.target.value)}
                                                placeholder={`Ask ${characterName} about their experiences...`}
                                                className="flex-1 px-4 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-indigo-500"
                                                disabled={isLoading}
                                            />
                                            <button
                                                type="submit"
                                                disabled={isLoading || !userInput.trim()}
                                                className={`px-6 py-2 font-medium rounded-lg transition-colors ${
                                                    isLoading || !userInput.trim()
                                                        ? 'bg-gray-400 text-gray-600 cursor-not-allowed'
                                                        : 'bg-indigo-600 hover:bg-indigo-700 text-white'
                                                }`}
                                            >
                                                {isLoading ? 'Sending...' : 'Send'}
                                            </button>
                                        </form>
                                    </div>
                                </div>

                                {/* Thesis Development Tracker */}
                                <div className="bg-white bg-opacity-10 backdrop-blur-md rounded-xl p-6 text-white">
                                    <h3 className="text-lg font-bold mb-3">📝 Thesis Development</h3>
                                    <div className="bg-white bg-opacity-20 rounded-lg p-4">
                                        <label className="block text-sm font-medium mb-2">
                                            Your emerging thesis (student can edit):
                                        </label>
                                        <textarea
                                            value={currentThesis}
                                            onChange={(e) => setCurrentThesis(e.target.value)}
                                            rows={3}
                                            className="w-full px-3 py-2 bg-white bg-opacity-90 text-gray-800 rounded-lg focus:outline-none focus:bg-opacity-100"
                                            placeholder="As you talk with Jonas, develop your thesis here..."
                                        />
                                    </div>
                                </div>

                                {error && (
                                    <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg">
                                        <strong>Error:</strong> {error}
                                    </div>
                                )}
                            </div>
                        )}

                        {/* Footer */}
                        <div className="text-center mt-8">
                            <p className="text-white opacity-75 text-sm">
                                Character-based learning for middle school English • Try asking about emotions, choice, sameness, or family!
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<CharacterTutorApp />, document.getElementById('root'));
    </script>
</body>
</html>
